@using Microsoft.AspNetCore.Identity
@using KDemia.Models

@inject UserManager<User> UserManager

@model KDemia.Models.User
@{
    ViewData["Title"] = "Kullanıcı Düzenle";
    Layout = "_AdminLayout";

    var roles = await UserManager.GetRolesAsync(Model);
    var currentRole = roles.FirstOrDefault() ?? "User";
}

<section role="main" class="content-body">
    <header class="page-header">
        <h2>Kullanıcı Düzenle</h2>
    </header>

    <div class="row">
        <div class="col-lg-8">
            <section class="card card-modern">
                <header class="card-header">
                    <h2 class="card-title">Kullanıcı Bilgileri</h2>
                </header>
                <div class="card-body">

                    <form asp-action="Edit" method="post">
                        <div asp-validation-summary="ModelOnly" class="alert alert-danger"></div>

                        <input type="hidden" asp-for="Id" />

                        <div class="form-group mb-3">
                            <label class="control-label font-weight-bold">Adı Soyadı</label>
                            <input asp-for="FullName" class="form-control" />
                            <span asp-validation-for="FullName" class="text-danger"></span>
                        </div>

                        <div class="form-group mb-3">
                            <label class="control-label font-weight-bold">E-Posta</label>
                            <input asp-for="Email" class="form-control" type="email" />
                            <span asp-validation-for="Email" class="text-danger"></span>
                        </div>

                        <div class="form-group mb-3">
                            <label class="control-label font-weight-bold">Mevcut Rol</label>
                            <input type="text" class="form-control" value="@currentRole" disabled />
                            <small class="text-muted">
                                <i class="fas fa-exclamation-triangle"></i>
                                Rol değişikliğini "Kullanıcı Listesi" sayfasından yapabilirsiniz.
                            </small>
                        </div>

                        <div class="alert alert-info mt-3">
                            <i class="fas fa-info-circle"></i> Not: Kullanıcı şifreleri güvenlik gereği buradan görüntülenemez.

                            <div class="form-group text-end mt-4">
                                <a asp-action="ControlPanel" class="btn btn-default me-2">İptal</a>
                                <button type="submit" class="btn btn-primary">Kaydet</button>
                            </div>
                        </div>

                    </form>
                </div>
            </section>
        </div>
    </div>
</section>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}